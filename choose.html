<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Photobooth</title>
  <link rel="stylesheet" href="Options.css">
</head>
<body>
<div class="stack-container">
  <div class="left-panel">
    <div class="gallery" id="gallery"></div>
  </div>

  <div class="right-panel">
    <h2 class="polaroid-heading">SELECT 4 PHOTOS</h2>
    <div class="frame-and-options">
    <div class="polaroid-frame" id="polaroid"></div>

    <div class="frame-options">
      <h2 class="frame-heading">FRAME COLORS</h2>
      <div class="color-options">
        <button class="color-btn" data-color="#E0D7CC"></button>
        <button class="color-btn" data-color="#ffffff"></button>
        <button class="color-btn" data-color="#151613"></button>
        <button class="color-btn" data-color="#5B5348"></button>
        <button class="color-btn" data-color="#392418"></button>
        <button class="color-btn" data-color="#5B3348"></button>
      </div>
      <a class="confirm-button" onclick="saveSelection()">CONFIRM</a>
    </div>
  </div>  </div>
</div>
  
<script>
  const gallery = document.getElementById('gallery');
  const polaroid = document.getElementById('polaroid');

  const photos = JSON.parse(localStorage.getItem("capturedPhotos")) || [];

  photos.forEach(src => {
    const img = document.createElement('img');
    img.src = src;
    img.addEventListener('click', () => {
      img.classList.toggle('selected');
      const selected = document.querySelectorAll('.gallery img.selected');
      if (selected.length > 4) {
        img.classList.remove('selected'); // limit to 4
      }

      // âœ… Automatically stack when 4 are selected
      if (selected.length === 4) {
        polaroid.innerHTML = ''; // clear frame

        const column = document.createElement('div');
        column.className = 'image-column';

        selected.forEach(img => {
          const stacked = document.createElement('img');
          stacked.src = img.src;
          stacked.style.border = '1px solid #000000';
          column.appendChild(stacked);
        });

        polaroid.appendChild(column);
      }
    });
    gallery.appendChild(img);
  });

  // Color option buttons
const colorButtons = document.querySelectorAll('.color-btn');
colorButtons.forEach(btn => {
  const chosenColor = btn.getAttribute('data-color');
  btn.style.backgroundColor = chosenColor; // show color in circle

  btn.addEventListener('click', () => {
    polaroid.style.backgroundColor = chosenColor;
  });
});

function saveSelection() {
  const selected = Array.from(document.querySelectorAll('.gallery img.selected'))
                        .map(img => img.src);

  const frameColor = document.getElementById('polaroid').style.backgroundColor;

  // Save to localStorage
  localStorage.setItem("selectedPhotos", JSON.stringify(selected));
  localStorage.setItem("frameColor", frameColor);

  // Redirect to drop page
  window.location.href = "Drop.html";
}
</script>
</body>
</html>